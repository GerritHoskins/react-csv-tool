(this["webpackJsonpreact-boilerplate"]=this["webpackJsonpreact-boilerplate"]||[]).push([[0],{22:function(e,a,t){e.exports=t(42)},41:function(e,a,t){},42:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),c=t(2),r=t.n(c),s=t(1),i=t(5),o=t.n(i),d=t(45),m=t(16),u=t.n(m),p=t(14),f=t(17),b=t.n(f),h=t(18);function g(e,a,t,n){const l=function(e,a,t){const n=a.findIndex(e=>e.id===t),l=a.findIndex(e=>"email"===e.fieldName),c=[],r=Object.entries(e.data.slice(1).filter(e=>!(!e[n]||!e[l]||"#N/A"===e[n]||"#N/A"===e[l])||(c.push(e),!1)).reduce((e,a)=>(e[a[n]]?e[a[n]]=[...e[a[n]],a]:e[a[n]]=[a],e),{})).map(([e,t])=>{let n={};return a.forEach((e,a)=>{n[e.fieldName]=t[0][a]}),t.length>1&&t.slice(1).forEach(e=>{a.forEach((a,t)=>{a.shouldMerge||(n[a.fieldName]="".concat(n[a.fieldName],"; ").concat(e[t]))})}),n}),s={},i=[[]];r.forEach(e=>{isNaN(Number(s[e.email]))?(s[e.email]=0,i[0].push(e)):(s[e.email]=s[e.email]+1,s[e.email]<i.length?i[s[e.email]].push(e):i.push([e]))});const o=c.map(e=>{let t={};return a.forEach((a,n)=>{t[a.fieldName]=e[n]}),t});return[r,i,o]}(e,a,t),c=Object(s.a)(l,3);!function(e,a,t,n){const l=new b.a,c=o.a.unparse(e);l.file("First Format Result - ".concat(e.length,".csv"),c,{type:"text/csv;charset=utf-8;"});const r=l.folder("Second Format Files");a.forEach((e,a)=>{const t=o.a.unparse(e);r.file("Second Result Batch #".concat(a+1," - ").concat(e.length," Entries.csv"),t,{type:"text/csv;charset=utf-8;"})});const s=o.a.unparse(t);l.file("Malformed Entries - ".concat(t.length,".csv"),s,{type:"text/csv;charset=utf-8;"}),l.generateAsync({type:"blob"}).then(e=>{Object(h.saveAs)(e,"Blast Data.zip"),n()})}(c[0],c[1],c[2],n)}var E=t(8),N=t(9);var v=({pId:e,initialFields:a,fieldsets:t})=>{const c=Object(n.useState)(a),r=Object(s.a)(c,2),i=r[0],o=r[1],m=Object(n.useState)(e),u=Object(s.a)(m,2),p=u[0],f=u[1],b=Object(n.useCallback)(({source:e,destination:a})=>{a&&o(t=>{const n=[...t],l=n.splice(e.index,1),c=Object(s.a)(l,1)[0];return n.splice(a.index,0,c),n})},[o]);return l.a.createElement(N.a,{onDragEnd:b},l.a.createElement(N.c,{droppableId:"droppable"},e=>l.a.createElement(l.a.Fragment,null,l.a.createElement("div",Object.assign({},e.droppableProps,{ref:e.innerRef,className:"fields"}),i.map((e,a)=>l.a.createElement(N.b,{key:e.id,draggableId:e.id,index:a},(t,n)=>l.a.createElement("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{className:n.isDragging?"field isDragged":"field"}),l.a.createElement("div",{className:"bar"},l.a.createElement("div",null),l.a.createElement("div",null),l.a.createElement("div",null)),l.a.createElement("span",null,a),l.a.createElement("input",{value:e.fieldName,placeholder:"Column Name",onChange:t=>{const n=t.target.value;o(t=>[...t.slice(0,a),Object(E.a)(Object(E.a)({},e),{},{fieldName:n}),...t.slice(a+1)])}}),l.a.createElement("button",{className:"primaryToggle",disabled:e.id===p,onClick:()=>f(e.id)},"Identifier"),l.a.createElement("button",{className:e.shouldMerge?"shouldMerge active":"shouldMerge",onClick:()=>o(t=>[...t.slice(0,a),Object(E.a)(Object(E.a)({},e),{},{shouldMerge:!e.shouldMerge}),...t.slice(a+1)])},"Fixed"),l.a.createElement("button",{className:"delete",disabled:1===i.length,onClick:()=>o(e=>[...e.slice(0,a),...e.slice(a+1)])},"X")))),e.placeholder),l.a.createElement("button",{className:"addField",onClick:()=>o(e=>[...e,{id:Object(d.a)(),fieldName:"",shouldMerge:!1}])},"Add Column"))))},O=(t(39),t(20)),j=t.n(O);const w=({meta:e})=>{const a=e.name,t=e.percent,n=e.status,c=e.previewUrl;return l.a.createElement("div",{className:"preview-box"},l.a.createElement("img",{src:c}),l.a.createElement("span",{className:"name"},a)," -",l.a.createElement("span",{className:"status"},n),"done"!==n&&l.a.createElement("span",{className:"percent"},"\xa0(",Math.round(t),"%)"))};var C=()=>l.a.createElement("div",{className:"DropZoneInput"},l.a.createElement("div",null,l.a.createElement(j.a,{getUploadParams:({file:e})=>{const a=new FormData;return a.append("dataFiles",e),{url:"http://localhost:4000/uploadmultifile",body:a}},onChangeStatus:({xhr:e})=>{e&&(e.onreadystatechange=()=>{if(4===e.readyState){const a=JSON.parse(e.response);console.log(a)}})},styles:{dropzone:{overflow:"auto",border:"1px solid #999",background:"#f5f5f5"},inputLabelWithFiles:{margin:"20px 3%"}},canRemove:!1,PreviewComponent:w,accept:"image/*,audio/*,video/*"})));t(40),t(41);function y(){const e=Object(n.useMemo)(()=>function(){const e=new URLSearchParams(window.location.search);if(e.has("fields")&&e.has("primary")){const a=e.get("fields").split("|"),t=Number(e.get("primary"));let n="";return[a.map((e,a)=>{const l=e.split("-"),c=Object(s.a)(l,2),r=c[0],i=c[1],o=Object(d.a)();return a===t&&(n=o),{id:o,fieldName:r,shouldMerge:"true"===i}}),n]}return[[{id:Object(d.a)(),fieldName:"",shouldMerge:!1}],""]}(),[]),a=Object(s.a)(e,2),t=a[0],c=a[1],r=Object(n.useState)(c),i=Object(s.a)(r,2),m=i[0],f=(i[1],Object(n.useState)(t)),b=Object(s.a)(f,2),h=b[0],E=(b[1],Object(n.useState)()),N=Object(s.a)(E,2),O=N[0],j=N[1],w=Object(n.useState)(!1),y=Object(s.a)(w,2),S=y[0],k=y[1],x=function(e,a,t){if(!e)return[!1,"You need to upload a CSV file first"];if(a.length!==e.data[0].length)return[!1,"Error1, ".concat(e.data[0].length," Error12, ").concat(a.length," ")];if(!a.find(e=>"email"===e.fieldName))return[!1,'Error3"'];if(!t||!a.find(e=>e.id===t))return[!1,"Error13"];if(a.find(e=>!e.fieldName))return[!1,"Error15"];return[!0,""]}(O,h,m),M=Object(s.a)(x,2),F=M[0],I=M[1];return l.a.createElement("div",{className:"App"},l.a.createElement("div",{className:"wrapper"},l.a.createElement("h1",null,"Quick and Drag - CSV Tool"),l.a.createElement("h2",null,"Upload CSV:"),l.a.createElement(C,null),l.a.createElement("input",{className:"fileInput",type:"file",placeholder:"scv",onChange:e=>{e.target.files&&e.target.files[0]&&o.a.parse(e.target.files[0],{complete:e=>j(e)})}}),l.a.createElement("div",{className:"configTitle"},l.a.createElement("h2",null,"Enter columns:"),l.a.createElement("button",{onClick:()=>{u()(function(e,a){const t=new URLSearchParams;return t.set("fields",""),t.set("primary",e.findIndex(e=>e.id===a)),e.forEach((a,n)=>{const l=t.get("fields");t.set("fields","".concat(l).concat(a.fieldName,"-").concat(a.shouldMerge).concat(n===e.length-1?"":"|"))}),"".concat(window.location.origin,"?").concat(t.toString())}(h,m)),Object(p.b)("Copied link to clipboard")}},"Copy Permalink")),l.a.createElement(v,{fieldsets:h,pId:m,initialFields:t}),l.a.createElement("h2",null,"Download new data set"),!F&&l.a.createElement("div",{className:"invalidReason"},I),l.a.createElement("button",{className:F?"download":"invalidReason",onClick:()=>{k(!0),g(O,h,m,()=>k(!1))},disabled:!F||S},F?S?"Loading ...":"Download now":"Error. Check your input fields.")),l.a.createElement(p.a,null))}const S=document.getElementById("root");r.a.render(l.a.createElement(y,null),S)}},[[22,1,2]]]);
//# sourceMappingURL=main.ef4bc00e.chunk.js.map